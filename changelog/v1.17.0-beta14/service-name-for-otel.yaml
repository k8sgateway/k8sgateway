changelog:
  - type: NEW_FEATURE
    resolvesIssue: false
    issueLink: https://github.com/solo-io/gloo/issues/7791
    description: >-
      Add the ability to set the source of `service_name` field in the OpenTelemetry Config based on the Gateway name.

      A new field has been added to the Gloo [Open Telemetry](https://docs.solo.io/gloo-edge/latest/reference/api/github.com/solo-io/gloo/projects/gloo/api/external/envoy/config/trace/v3/opentelemetry.proto.sk/#package-soloioenvoyconfigtracev3) configuration,
      which currently accepts one value, `GatewayName`, which is also the default.

      In the Gloo translation, the gateway name is taken from the `MetadataStatic` data of the parent [Listener](https://docs.solo.io/gloo-edge/latest/reference/api/github.com/solo-io/gloo/projects/gloo/api/v1/proxy.proto.sk/#listener),
      Specifically, the `resourceRef.name` field of the [SourceRef](https://docs.solo.io/gloo-edge/latest/reference/api/github.com/solo-io/gloo/projects/gloo/api/v1/proxy.proto.sk/#sourceref) with
      a `resourceKind` of `*v1.Gateway` is used to set the `service_name`.

      If the metadata is not present, or in a different format, the `service_name` will be set to the following:
      - Metadata is in deprecate format: "deprecated_metadata"
      - Unknown metadata format: "unknown_metadata"
      - Gateway metadata is not found: "undefined_gateway"

      Breaking change: the `ToEnvoyOpenTelemetryonfiguration` function in "github.com/solo-io/gloo/projects/gloo/pkg/api/v1/options/tracing" has
      been removed and replaced with `ToEnvoyOpenTelemetryConfiguration`, and the signature has been updated to:
      `ToEnvoyOpenTelemetryConfiguration(ctx context.Context, glooOpenTelemetryConfig *envoytracegloo.OpenTelemetryConfig, clusterName string, parentListener *gloov1.Listener) (*envoytrace.OpenTelemetryConfig, error)`