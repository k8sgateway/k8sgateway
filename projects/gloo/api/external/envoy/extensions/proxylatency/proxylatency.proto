syntax = "proto3";

package envoy.config.filter.http.proxylatency.v2;
option go_package = "github.com/solo-io/gloo/projects/gloo/pkg/api/external/envoy/extensions/proxylatency";

import "gogoproto/gogo.proto";
option (gogoproto.equal_all) = true;

// Configure the proxy latency fitler. This filter measures the latency
// incurred by the filter chain in a histogram.
message ProxyLatency {

    enum Measurement {
        DEFAULT = 0;
        FIRST_BYTE = 1;
        LAST_BYTE = 2;
    }

    // When to start measuring - the time of the last byte received, or the first one.
    // if not specified, defaults to last byte
    Measurement start = 1;

    // When to end measuring - the time of the last byte received, or the first one.
    // if not specified, defaults to first byte
    Measurement end = 2;

    // Charge a stat per upstream cluster.
    bool charge_cluster_stat = 3;
    // Charge a stat per listener.
    bool charge_listener_stat = 4;
}
