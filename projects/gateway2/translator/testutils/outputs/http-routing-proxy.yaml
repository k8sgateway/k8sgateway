---
listeners:
- aggregateListener:
    httpFilterChains:
    - matcher: {}
      virtualHostRefs:
      - http~bar.example.com
      - http~foo.example.com
    httpResources:
      virtualHosts:
        http~bar.example.com:
          domains:
          - bar.example.com
          name: http~bar.example.com
          routes:
          - matchers:
            - headers:
              - name: env
                regex: true
                value: canary
              prefix: /
            routeAction:
              multi:
                destinations:
                - destination:
                    kube:
                      port: 8080
                      ref:
                        name: bar-svc-canary
                        namespace: default
        http~foo.example.com:
          domains:
          - foo.example.com
          name: http~foo.example.com
          routes:
          - matchers:
            - prefix: /login
            routeAction:
              multi:
                destinations:
                - destination:
                    kube:
                      port: 8080
                      ref:
                        name: foo-svc
                        namespace: default
  bindAddress: '::'
  bindPort: 80
  name: http
metadata:
  name: example-gateway
  namespace: default