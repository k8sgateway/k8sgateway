
---
title: "extproc.proto"
weight: 5
---

<!-- Code generated by solo-kit. DO NOT EDIT. -->


### Package: `extproc.options.gloo.solo.io` 
#### Types:


- [Settings](#settings)
- [RouteSettings](#routesettings)
- [GrpcService](#grpcservice)
- [Overrides](#overrides)
- [HeaderForwardingRules](#headerforwardingrules)
  



##### Source File: [github.com/solo-io/gloo/projects/gloo/api/v1/enterprise/options/extproc/extproc.proto](https://github.com/solo-io/gloo/blob/master/projects/gloo/api/v1/enterprise/options/extproc/extproc.proto)





---
### Settings

 
Enterprise-only: Configuration for Envoy's [External Processing Filter](https://www.envoyproxy.io/docs/envoy/latest/configuration/http/http_filters/ext_proc_filter).
The External Processing filter allows for calling out to an external gRPC service at a specified
point within a HTTP filter chain. The external service may access and modify various parts of the
request or response, and may terminate processing.
Envoy's External Processing Filter is considered a work in progress and has an unknown security posture.
Only use this if you know what you are doing!

```yaml
"grpcService": .extproc.options.gloo.solo.io.GrpcService
"filterStage": .filters.gloo.solo.io.FilterStage
"failureModeAllow": .google.protobuf.BoolValue
"processingMode": .solo.io.envoy.extensions.filters.http.ext_proc.v3.ProcessingMode
"messageTimeout": .google.protobuf.Duration
"statPrefix": .google.protobuf.StringValue
"mutationRules": .solo.io.envoy.config.common.mutation_rules.v3.HeaderMutationRules
"maxMessageTimeout": .google.protobuf.Duration
"disableClearRouteCache": .google.protobuf.BoolValue
"forwardRules": .extproc.options.gloo.solo.io.HeaderForwardingRules
"filterMetadata": .google.protobuf.Struct
"allowModeOverride": .google.protobuf.BoolValue

```

| Field | Type | Description |
| ----- | ---- | ----------- | 
| `grpcService` | [.extproc.options.gloo.solo.io.GrpcService](../extproc.proto.sk/#grpcservice) | Required. Configuration for the gRPC service that the filter will communicate with. |
| `filterStage` | [.filters.gloo.solo.io.FilterStage](../../../../filters/stages.proto.sk/#filterstage) | Where in the HTTP filter chain to insert the filter. |
| `failureModeAllow` | [.google.protobuf.BoolValue](https://developers.google.com/protocol-buffers/docs/reference/csharp/class/google/protobuf/well-known-types/bool-value) | By default, if the gRPC stream cannot be established, or if it is closed prematurely with an error, the filter will fail. Specifically, if the response headers have not yet been delivered, then it will return a 500 error downstream. If they have been delivered, then instead the HTTP stream to the downstream client will be reset. With this parameter set to true, however, then if the gRPC stream is prematurely closed or could not be opened, processing continues without error. |
| `processingMode` | [.solo.io.envoy.extensions.filters.http.ext_proc.v3.ProcessingMode](../../../../../external/envoy/extensions/filters/http/ext_proc/v3/processing_mode.proto.sk/#processingmode) | Specifies default options for how HTTP headers, trailers, and bodies are sent. |
| `messageTimeout` | [.google.protobuf.Duration](https://developers.google.com/protocol-buffers/docs/reference/csharp/class/google/protobuf/well-known-types/duration) | Specifies the timeout for each individual message sent on the stream and when the filter is running in synchronous mode. Whenever the proxy sends a message on the stream that requires a response, it will reset this timer, and will stop processing and return an error (subject to the processing mode) if the timer expires before a matching response is received. There is no timeout when the filter is running in asynchronous mode. Zero is a valid config which means the timer will be triggered immediately. If not configured, default is 200 milliseconds. |
| `statPrefix` | [.google.protobuf.StringValue](https://developers.google.com/protocol-buffers/docs/reference/csharp/class/google/protobuf/well-known-types/string-value) | Optional additional prefix to use when emitting statistics. This allows to distinguish emitted statistics between configured *ext_proc* filters in an HTTP filter chain. |
| `mutationRules` | [.solo.io.envoy.config.common.mutation_rules.v3.HeaderMutationRules](../../../../../external/envoy/config/common/mutation_rules/v3/mutation_rules.proto.sk/#headermutationrules) | Rules that determine what modifications an external processing server may make to message headers. If not set, all headers may be modified except for "host", ":authority", ":scheme", ":method", and headers that start with the header prefix set via [header_prefix](https://www.envoyproxy.io/docs/envoy/latest/api-v3/config/bootstrap/v3/bootstrap.proto#envoy-v3-api-field-config-bootstrap-v3-bootstrap-header-prefix) (which is usually "x-envoy"). Note that changing headers such as "host" or ":authority" may not in itself change Envoy's routing decision, as routes can be cached. To also force the route to be recomputed, set the [clear_route_cache](https://www.envoyproxy.io/docs/envoy/latest/api-v3/service/ext_proc/v3/external_processor.proto#envoy-v3-api-field-service-ext-proc-v3-commonresponse-clear-route-cache) field to true in the same response. |
| `maxMessageTimeout` | [.google.protobuf.Duration](https://developers.google.com/protocol-buffers/docs/reference/csharp/class/google/protobuf/well-known-types/duration) | Specify the upper bound of [override_message_timeout](https://www.envoyproxy.io/docs/envoy/latest/api-v3/service/ext_proc/v3/external_processor.proto#envoy-v3-api-field-service-ext-proc-v3-processingresponse-override-message-timeout). If not specified, by default it is 0, which will effectively disable the `override_message_timeout` API. |
| `disableClearRouteCache` | [.google.protobuf.BoolValue](https://developers.google.com/protocol-buffers/docs/reference/csharp/class/google/protobuf/well-known-types/bool-value) | Prevents clearing the route-cache when the [clear_route_cache](https://www.envoyproxy.io/docs/envoy/latest/api-v3/service/ext_proc/v3/external_processor.proto#envoy-v3-api-field-service-ext-proc-v3-commonresponse-clear-route-cache) field is set in an external processor response. |
| `forwardRules` | [.extproc.options.gloo.solo.io.HeaderForwardingRules](../extproc.proto.sk/#headerforwardingrules) | Allow headers matching the `forward_rules` to be forwarded to the external processing server. If not set, all headers are forwarded to the external processing server. |
| `filterMetadata` | [.google.protobuf.Struct](https://developers.google.com/protocol-buffers/docs/reference/csharp/class/google/protobuf/well-known-types/struct) | Additional metadata to be added to the filter state for logging purposes. The metadata will be added to StreamInfo's filter state under the namespace corresponding to the ext_proc filter name. |
| `allowModeOverride` | [.google.protobuf.BoolValue](https://developers.google.com/protocol-buffers/docs/reference/csharp/class/google/protobuf/well-known-types/bool-value) | If `allow_mode_override` is set to true, the filter config [processing_mode](https://www.envoyproxy.io/docs/envoy/latest/api-v3/extensions/filters/http/ext_proc/v3/ext_proc.proto#envoy-v3-api-field-extensions-filters-http-ext-proc-v3-externalprocessor-processing-mode) can be overridden by the response message from the external processing server [mode_override](https://www.envoyproxy.io/docs/envoy/latest/api-v3/service/ext_proc/v3/external_processor.proto#envoy-v3-api-field-service-ext-proc-v3-processingresponse-mode-override). If not set, `mode_override` API in the response message will be ignored. |




---
### RouteSettings

 
External processor settings that can be configured on a per-route basis.

```yaml
"disabled": .google.protobuf.BoolValue
"overrides": .extproc.options.gloo.solo.io.Overrides

```

| Field | Type | Description |
| ----- | ---- | ----------- | 
| `disabled` | [.google.protobuf.BoolValue](https://developers.google.com/protocol-buffers/docs/reference/csharp/class/google/protobuf/well-known-types/bool-value) | Set to true to disable the External Processing filter for this route. Only one of `disabled` or `overrides` can be set. |
| `overrides` | [.extproc.options.gloo.solo.io.Overrides](../extproc.proto.sk/#overrides) | Override specific configuration for this route. Only one of `overrides` or `disabled` can be set. |




---
### GrpcService



```yaml
"extProcServerRef": .core.solo.io.ResourceRef
"authority": string
"retryPolicy": .solo.io.envoy.config.core.v3.RetryPolicy
"timeout": .google.protobuf.Duration
"initialMetadata": []solo.io.envoy.config.core.v3.HeaderValue

```

| Field | Type | Description |
| ----- | ---- | ----------- | 
| `extProcServerRef` | [.core.solo.io.ResourceRef](../../../../../../../../../solo-kit/api/v1/ref.proto.sk/#resourceref) | A reference to the Upstream representing the external processor gRPC server. See https://www.envoyproxy.io/docs/envoy/latest/api-v3/service/ext_proc/v3/external_processor.proto for details. |
| `authority` | `string` | The `:authority` header in the grpc request. If this field is not set, the authority header value will be the cluster name. Note that this authority does not override the SNI. The SNI is provided by the transport socket of the cluster. |
| `retryPolicy` | [.solo.io.envoy.config.core.v3.RetryPolicy](../../../../../external/envoy/config/core/v3/base.proto.sk/#retrypolicy) | Indicates the retry policy for re-establishing the gRPC stream This field is optional. If max interval is not provided, it will be set to ten times the provided base interval. Currently only supported for xDS gRPC streams. If not set, xDS gRPC streams default base interval:500ms, maximum interval:30s will be applied. |
| `timeout` | [.google.protobuf.Duration](https://developers.google.com/protocol-buffers/docs/reference/csharp/class/google/protobuf/well-known-types/duration) | The timeout for the gRPC request. This is the timeout for a specific request. |
| `initialMetadata` | [[]solo.io.envoy.config.core.v3.HeaderValue](../../../../../external/envoy/config/core/v3/base.proto.sk/#headervalue) | Additional metadata to include in streams initiated to the GrpcService. This can be used for scenarios in which additional ad hoc authorization headers (e.g. `x-foo-bar: baz-key`) are to be injected. For more information, including details on header value syntax, see the documentation on [custom request headers](https://www.envoyproxy.io/docs/envoy/latest/configuration/http/http_conn_man/headers#config-http-conn-man-headers-custom-request-headers). |




---
### Overrides



```yaml
"processingMode": .solo.io.envoy.extensions.filters.http.ext_proc.v3.ProcessingMode
"grpcService": .extproc.options.gloo.solo.io.GrpcService

```

| Field | Type | Description |
| ----- | ---- | ----------- | 
| `processingMode` | [.solo.io.envoy.extensions.filters.http.ext_proc.v3.ProcessingMode](../../../../../external/envoy/extensions/filters/http/ext_proc/v3/processing_mode.proto.sk/#processingmode) | Set a different processing mode for this route than the default. |
| `grpcService` | [.extproc.options.gloo.solo.io.GrpcService](../extproc.proto.sk/#grpcservice) | Set a different gRPC service for this route than the default. |




---
### HeaderForwardingRules

 
The HeaderForwardingRules structure specifies what headers are
allowed to be forwarded to the external processing server.
See https://www.envoyproxy.io/docs/envoy/latest/api-v3/extensions/filters/http/ext_proc/v3/ext_proc.proto#extensions-filters-http-ext-proc-v3-headerforwardingrules
for details.

```yaml
"allowedHeaders": .solo.io.envoy.type.matcher.v3.ListStringMatcher
"disallowedHeaders": .solo.io.envoy.type.matcher.v3.ListStringMatcher

```

| Field | Type | Description |
| ----- | ---- | ----------- | 
| `allowedHeaders` | [.solo.io.envoy.type.matcher.v3.ListStringMatcher](../../../../../external/envoy/type/matcher/v3/string.proto.sk/#liststringmatcher) | If set, specifically allow any header in this list to be forwarded to the external processing server. This can be overridden by the below `disallowed_headers`. |
| `disallowedHeaders` | [.solo.io.envoy.type.matcher.v3.ListStringMatcher](../../../../../external/envoy/type/matcher/v3/string.proto.sk/#liststringmatcher) | If set, specifically disallow any header in this list to be forwarded to the external processing server. This overrides the above `allowed_headers` if a header matches both. |





<!-- Start of HubSpot Embed Code -->
<script type="text/javascript" id="hs-script-loader" async defer src="//js.hs-scripts.com/5130874.js"></script>
<!-- End of HubSpot Embed Code -->
